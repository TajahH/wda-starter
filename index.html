<!DOCTYPE html>
<html>

<head>
  <title>Showing Movie Data from an API</title>
  <link rel="stylesheet" href="./css/style.css" />
  <script type="module" src="./js/scripts.js"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>

<body>
  <div class="page-section">
    <h1>Movie Data</h1>
    <div class="movie-container" x-cloak x-data="movieListComponent()" x-init="init()">
      <select x-model="filter_year">
        <option value="">All Years</option>
        <option value="2023">2023</option>
        <option value="2024">2024</option>
      </select>
      <div x-show="filter_year !== ''">
        Showing movies from <span x-text="filter_year"></span>
      </div>
      <form @submit.prevent="doSearch()" style="margin: 0 0 1rem 0;">
        <input type="search" placeholder="Search movies..." x-model="searchText" aria-label="Search movies by keyword">
        <button type="submit">Search</button>
        <button type="button" @click="clearSearch()">Clear</button>
        <div>
          Watchlist: <span x-text="watchlistCount"></span>
        </div>
      </form>
      <ul>
        <template x-for="movie in filteredMovies" :key="movie.id">
          <li>
            <a :href="`movie.html?movie_id=${movie.id}`" x-text="movie.title"></a>
            <img :src="movie && movie.poster_path ? `https://image.tmdb.org/t/p/w342${movie.poster_path}` : ''"
              :alt="movie ? (movie.title + ' poster') : ''" />
            <button class="watchlist-btn" :class="isInWatchlist(movie) ? 'watchlist-btn--clear' : ''" type="button"
              @click="toggleWatchlist(movie)" x-text="isInWatchlist(movie) ? 'Remove' : 'Add to watchlist'">
            </button>
          </li>
        </template>
      </ul>
    </div>
  </div>
</body>

</html>